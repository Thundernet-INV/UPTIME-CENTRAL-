const API = "/";

export async function fetchSummary() {
  return (await fetch(API + "api/summary")).json();
}

export async function fetchMonitors() {
  return (await fetch(API + "api/monitors")).json();
}

export function openStream(onMessage) {
  const es = new EventSource(API + "api/stream");
  es.addEventListener("tick", e => onMessage(JSON.parse(e.data)));
  return () => es.close();
}

export async function getBlocklist() {
  return (await fetch(API + "api/blocklist")).json();
}

export async function saveBlocklist(b) {
  return await fetch(API + "api/blocklist", {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(b)
  });
}
